;/*FB_PKG_DELIM*/

__d("createWebGLTexturedMeshProgram",["CometWebGLProgram"],(function(a,b,c,d,e,f,g){"use strict";var h="\nattribute vec3 a_position;\nattribute vec2 a_texcoord_0;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 transformMatrix;\nvarying vec2 v_texcoord_0;\n\nvoid main() {\n  v_texcoord_0 = a_texcoord_0;\n  gl_Position = projectionMatrix * viewMatrix * transformMatrix * vec4(a_position, 1.0);\n}\n",i="\nprecision mediump float;\n\nuniform sampler2D u_texture_0;\nvarying vec2 v_texcoord_0;\n\nvoid main() {\n  gl_FragColor = texture2D(u_texture_0, v_texcoord_0);\n}\n";function a(a){var b=new(c("CometWebGLProgram"))(a);return b.addShader(h,a.VERTEX_SHADER).addShader(i,a.FRAGMENT_SHADER).compile().setUniformDefaults({projectionMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],transformMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],viewMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]})}g["default"]=a}),98);
__d("CometWebGLRoundedRectangleMesh",["CometWebGLMesh","CometWebGLTexture","createWebGLTexturedMeshProgram"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f){f===void 0&&(f=5);this.$1=a;this.$2=new(c("CometWebGLMesh"))(a,c("createWebGLTexturedMeshProgram")(a),{interleaved:!1});this.$2.addAttribute("a_position",{offset:0});this.$3=new(c("CometWebGLTexture"))(a);this.$2.setUniform("u_texture_0",this.$3);a=b/2;var g=d/2,h=0,i=[-a+e,g,h,a-e,g,h,-a,g-e,h,-a+e,g-e,h,a-e,g-e,h,a,g-e,h,-a,-g+e,h,-a+e,-g+e,h,a-e,-g+e,h,a,-g+e,h,-a+e,-g,h,a-e,-g,h],j=[0,1,4,4,3,0,2,3,7,7,6,2,3,4,8,8,7,3,4,5,9,9,8,4,7,8,11,11,10,7],k=[],l=[],m=Math.PI/2/f;for(var n=1;n<f;n++)k.push(e-e*Math.cos(m*n)),l.push(e-e*Math.sin(m*n));m=5;for(n=0;n<f-1;n++){var o=i.length/3;i.push(a-k[n],g-l[n],h);j.push(o,m,4);m=o}j.push(1,m,4);m=2;for(o=0;o<f-1;o++){n=i.length/3;i.push(-a+k[o],g-l[o],h);j.push(n,3,m);m=n}j.push(0,3,m);m=9;for(n=0;n<f-1;n++){o=i.length/3;i.push(a-k[n],-g+l[n],h);j.push(m,o,8);m=o}j.push(m,11,8);m=6;for(o=0;o<f-1;o++){n=i.length/3;i.push(-a+k[o],-g+l[o],h);j.push(7,n,m);m=n}j.push(7,10,m);this.$2.addAttribute("a_texcoord_0",{offset:i.length*4});n=e/b;o=e/d;i.push(n,0,1-n,0,0,o,n,o,1-n,o,1,o,0,1-o,n,1-o,1-n,1-o,1,1-o,n,1,1-n,1);for(h=0;h<f-1;h++)i.push(1-k[h]/b,l[h]/d);for(g=0;g<f-1;g++)i.push(k[g]/b,l[g]/d);for(a=0;a<f-1;a++)i.push(1-k[a]/b,1-l[a]/d);for(m=0;m<f-1;m++)i.push(k[m]/b,1-l[m]/d);this.$2.bufferData(i);this.$2.bufferIndex(j)}var b=a.prototype;b.setTransform=function(a){this.$2.setUniform("transformMatrix",a)};b.setTextureSource=function(a){this.$3.setSource(a)};b.draw=function(a,b){this.$2.setUniform("viewMatrix",a),this.$2.setUniform("projectionMatrix",b),this.$2.program.use(),this.$2.draw()};return a}();g["default"]=a}),98);
__d("XRImmersiveMediaStoryCard",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var b=this,c=document.createElement("canvas");c.width=a.width;c.height=a.height;this.$1=c.getContext("2d");this.$2=a.photoURL;this.$4=a.title;this.$5=a.subtitle;this.$6=a.description;this.$3=new Image();this.$3.crossOrigin="Anonymous";this.$3.onload=function(){b.$7(),a.reload()};this.$3.src=this.$2;this.$7()}var b=a.prototype;b.$7=function(){var a=this.$1.canvas.width,b=this.$1.canvas.height,c=48,d=6;this.$1.fillStyle="#ffffff";this.$1.fillRect(0,0,a,b);this.$1.fillStyle="#000000";this.$1.font="bold 16px sans-serif";this.$1.fillText(this.$4,d*2+c,20);this.$1.font="normal 14px sans-serif";this.$1.fillText(this.$5,d*2+c,40);this.$1.font="normal 16px sans-serif";b="";a=a-d*2;for(var e of this.$6){b+=e;if(this.$1.measureText(b).width>a){b=b.slice(0,-3)+"...";break}}this.$1.fillText(b,d,74);this.$1.beginPath();this.$1.arc(d+c/2,d+c/2,c/2,0,Math.PI*2);this.$3.complete&&(this.$1.clip(),this.$1.drawImage(this.$3,d,d))};b.getCanvas=function(){return this.$1.canvas};return a}();f["default"]=a}),66);
__d("createWebGLColoredMeshProgram",["CometWebGLProgram"],(function(a,b,c,d,e,f,g){"use strict";var h="\nattribute vec3 a_position;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 transformMatrix;\n\nvoid main() {\n  gl_Position = projectionMatrix * viewMatrix * transformMatrix * vec4(a_position, 1.0);\n}\n",i="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n  gl_FragColor = u_color;\n}\n";function a(a){var b=new(c("CometWebGLProgram"))(a);return b.addShader(h,a.VERTEX_SHADER).addShader(i,a.FRAGMENT_SHADER).compile().setUniformDefaults({projectionMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],transformMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],viewMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]})}g["default"]=a}),98);
__d("XRImmersiveMediaWindow",["CometWebGLMesh","createWebGLColoredMeshProgram"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e){this.$1=a;this.$2=new(c("CometWebGLMesh"))(a,c("createWebGLColoredMeshProgram")(a),{interleaved:!1});this.$2.addAttribute("a_position",{offset:0});a=b/2;b=d/2;d=[a,-b,-e,a,b,-e,-a,b,-e,-a,-b,-e];this.$2.bufferData(d);this.$2.bufferIndex([0,1,2,2,3,0]);this.$2.setUniform("u_color",[0,0,0,1])}var b=a.prototype;b.draw=function(a,b){var c=this.$1;c.depthMask(!1);c.stencilMask(255);c.clear(c.STENCIL_BUFFER_BIT);c.stencilFunc(c.ALWAYS,1,255);c.stencilOp(c.KEEP,c.KEEP,c.REPLACE);this.$2.setUniform("viewMatrix",a);this.$2.setUniform("projectionMatrix",b);this.$2.program.use();this.$2.draw();c.depthMask(!0);c.stencilFunc(c.EQUAL,1,255);c.stencilMask(0)};return a}();g["default"]=a}),98);
__d("XR3DPhotoViewer.react",["CometWebGLRoundedRectangleMesh","Matrices","ViewInVRButton.react","XRImmersiveMediaStoryCard","XRImmersiveMediaWindow","beginXRSession","formatDate","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=1.3,k=1,l=.03,m=.03,n=[0,0,-1.25],o=.2,p=512,q=1.5,r=.666489;function s(a,b,d){var e,f=b[0]<b[1],g=f?k:j,h=f?j:k,i=g+l*2,s=h+l*2+o,t=(f?s/i:1)*p,u=(f?1:i/s)*p,v=new(c("CometWebGLRoundedRectangleMesh"))(a,i,s,m);i=(i=d==null?void 0:d.time)!=null?i:null;i=i==null?"":c("formatDate")(i,"F j, Y");var w=new(c("XRImmersiveMediaStoryCard"))({description:(e=d==null?void 0:d.description)!=null?e:"",height:t,photoURL:(e=d==null?void 0:d.actorPhoto)!=null?e:"",reload:function(){v.setTextureSource(w.getCanvas())},subtitle:i,title:(t=d==null?void 0:d.actorName)!=null?t:"",width:u});e=(s-h)/2-l;v.setTransform([1,0,0,0,0,1,0,0,0,0,1,0,n[0],n[1]+e,n[2],1]);v.setTextureSource(w.getCanvas());i=new(c("XRImmersiveMediaWindow"))(a,g,h,-n[2]);d=f?b[1]:b[0];t=q;if(d!=null&&d!==r){u=-n[2]/2*Math.tan(r/2);s=-n[2]/2*Math.tan(d/2);t=q*u/s}e=c("Matrices").createScalingMatrix(t,t,1);return[i,v,e]}function a(a){var b=d("react-compiler-runtime").c(7),e=a.fov,f=a.gl,g=a.meshes,h=a.storyContext;if(f==null||e==null||g==null)return null;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h?(a=function(){var a=s(f,e,h),b=a[0],d=a[1];a=a[2];for(var i of g)i.setUniform("transformMatrix",a);i=function(a,c){f.enable(f.STENCIL_TEST);f.enable(f.DEPTH_TEST);f.enable(f.BLEND);f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA);f.clearColor(.33,.33,.33,1);f.clear(f.COLOR_BUFFER_BIT);for(a of a.views){var e=c.getViewport(a);f.viewport(e.x,e.y,e.width,e.height);e=a.transform.inverse.matrix;var h=a.projectionMatrix;b.draw(e,h);f.clear(f.DEPTH_BUFFER_BIT);for(var i of g)i.setUniform("projectionMatrix",h),i.setUniform("viewMatrix",e),i.program.use(),i.draw();f.stencilFunc(f.NOTEQUAL,1,255);d.draw(e,h)}f.disable(f.STENCIL_TEST)};c("beginXRSession")({draw:i,gl:f,sessionType:"immersive-vr"})},b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=a):a=b[4];a=a;var j;b[5]!==a?(j=i.jsx(c("ViewInVRButton.react"),{onPress:a}),b[5]=a,b[6]=j):j=b[6];return j}g["default"]=a}),98);
__d("XR3DPhotoViewerEntry.react",["XR3DPhotoViewer.react","XRViewerGating.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(2),e;b[0]!==a?(e=i.jsx(c("XRViewerGating.react"),{children:i.jsx(c("XR3DPhotoViewer.react"),babelHelpers["extends"]({},a))}),b[0]=a,b[1]=e):e=b[1];return e}g["default"]=a}),98);
__d("createWebGL3DPhotoProgram",["CometWebGLProgram","Matrices"],(function(a,b,c,d,e,f,g){"use strict";var h="\nattribute vec3 a_position;\nattribute vec2 a_texcoord_0;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 transformMatrix;\nvarying vec2 v_texcoord_0;\n\nvoid main() {\n  v_texcoord_0 = a_texcoord_0;\n  gl_Position = projectionMatrix * viewMatrix * transformMatrix * vec4(a_position, 1.0);\n}\n",i='\nprecision mediump float;\n\nvarying vec2 v_texcoord_0;\nuniform sampler2D u_texture_0;\n\nvoid main() {\n  // LOD refers to "level of detail" and is used for mipmap filtering.\n  // A positive LOD bias samples closer to the less detailed mipmap level,\n  // and a negative LOD bias samples closer to the more detailed mipmap level.\n  const float kLodBias = 0.0;\n  gl_FragColor = texture2D(u_texture_0, v_texcoord_0, kLodBias);\n}\n';function a(a){var b=new(c("CometWebGLProgram"))(a);return b.addShader(h,a.VERTEX_SHADER).addShader(i,a.FRAGMENT_SHADER).compile().setUniformDefaults({projectionMatrix:c("Matrices").createIdentityMat4(),transformMatrix:c("Matrices").createIdentityMat4(),viewMatrix:c("Matrices").createIdentityMat4()})}g["default"]=a}),98);
__d("createMeshesFromGLTF",["CometWebGLMesh","CometWebGLTexture","Promise","createWebGL3DPhotoProgram"],(function(a,b,c,d,e,f,g){"use strict";var h,i={POSITION:"a_position",TEXCOORD_0:"a_texcoord_0"};function a(a,d){var e=[],f=c("createWebGL3DPhotoProgram")(a),g=[],k=d.getMeshes();for(k of k){var l=k.primitives;for(l of l){var m=l.attributes,n=[],o=Infinity,p=0;for(m of Object.entries(m)){var q=m[0],r=m[1];if(typeof r==="number"){r=d.getAccessor(r);var s=d.getBufferView(r.bufferView);s.byteOffset<o&&(o=s.byteOffset);s.byteOffset+s.byteLength>p&&(p=s.byteOffset+s.byteLength);r=r.byteOffset!=null?r.byteOffset:0;n.push({byteOffset:s.byteOffset+r,name:q})}}n.sort(j);var t=new(c("CometWebGLMesh"))(a,f,{interleaved:!1});s=d.getBinarySource();for(r of n)if(r.name in i){q=r.byteOffset-o;m={offset:q};t.addAttribute(i[r.name],m)}t.bufferData(new Float32Array(s.buffer,s.byteOffset+o,(p-o)/4));l.indices!=null&&t.bufferIndex(d.getDataViewForAccessor(l.indices));if(l.material!=null){n=d.getMaterial(l.material);var u=n==null?void 0:(q=n.pbrMetallicRoughness)==null?void 0:(m=q.baseColorTexture)==null?void 0:m.index;u!=null&&(function(){var e=d.getTexture(u),f=d.getImage(e.source),i=new(c("CometWebGLTexture"))(a,{generateMipmaps:!0});g.push(new(h||(h=b("Promise")))(function(a,b){f.onload=function(){i.setSource(f,!1,!0),a()},f.onerror=function(){b()}}));t.setUniform("u_texture_0",i)})()}e.push(t)}}return(h||(h=b("Promise"))).all(g).then(function(){return e})}function j(a,b){return a.byteOffset-b.byteOffset}g["default"]=a}),98);
__d("glVec3CrossProduct",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}f["default"]=a}),66);
__d("glMatrixLookingAtTarget",["glVec3CrossProduct"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=[a[0]-b[0],a[1]-b[1],a[2]-b[2]];var d=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=d;b[1]/=d;b[2]/=d;d=c("glVec3CrossProduct")([0,1,0],b);var e=c("glVec3CrossProduct")(b,d);return[d[0],d[1],d[2],0,e[0],e[1],e[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]}g["default"]=a}),98);
__d("GLTFResource",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=[],this.$3=null,this.$4=null,this.$5=[],this.$6=[],this.$7=[],this.$8=[]}var b=a.prototype;b.addBinarySource=function(a,b,c){this.$3=new Uint8Array(a,b,c)};b.useJSON=function(a){var b;this.$4=(b=a.extras)!=null?b:Object.freeze({});this.$1=(b=a.accessors)!=null?b:[];this.$2=(b=a.bufferViews)!=null?b:[];this.$5=(b=a.images)!=null?b:[];this.$6=(b=a.materials)!=null?b:[];this.$7=(b=a.meshes)!=null?b:[];this.$8=(b=a.textures)!=null?b:[]};b.getBinarySource=function(){if(this.$3==null)throw c("unrecoverableViolation")("attempted to access binary source before it was set","webgl");return this.$3};b.hasBinarySource=function(){return this.$3!=null};b.getAccessor=function(a){a=this.$1[a];if(a==null)throw c("unrecoverableViolation")("accessor index out of range","webgl");return a};b.getBufferView=function(a){a=this.$2[a];if(a==null)throw c("unrecoverableViolation")("buffer view index out of range","webgl");return a};b.getExtras=function(){return this.$4};b.getMaterial=function(a){a=this.$6[a];if(a==null)throw c("unrecoverableViolation")("material index out of range","webgl");return a};b.getMeshes=function(){return this.$7};b.getTexture=function(a){a=this.$8[a];if(a==null)throw c("unrecoverableViolation")("texture index out of range","webgl");return a};b.getDataViewForAccessor=function(a){a=this.$1[a];if(a==null)throw c("unrecoverableViolation")("accessor index out of range","webgl");var b=this.$2[a.bufferView];if(b==null)throw c("unrecoverableViolation")("buffer view index out of range","webgl");if(b.buffer!==0)throw c("unrecoverableViolation")("external gltf buffers are not currently supported","webgl");var d=this.$3;if(d==null)throw c("unrecoverableViolation")("attempted to get an accessor before loading binary data","webgl");var e=d.byteOffset+b.byteOffset;switch(a.componentType){case 5120:return new Int8Array(d.buffer,e,b.byteLength);case 5121:return new Uint8Array(d.buffer,e,b.byteLength);case 5122:return new Int16Array(d.buffer,e,b.byteLength/2);case 5123:return new Uint16Array(d.buffer,e,b.byteLength/2);case 5124:return new Int32Array(d.buffer,e,b.byteLength/4);case 5125:return new Uint32Array(d.buffer,e,b.byteLength/4);case 5126:return new Float32Array(d.buffer,e,b.byteLength/4);default:throw c("unrecoverableViolation")("unsupported gl component type","webgl")}};b.getImage=function(a){a=this.$5[a];var b=this.getBufferView(a.bufferView),c=this.getBinarySource();c=new Uint8Array(c.buffer,c.byteOffset+b.byteOffset,b.byteLength);b=new Blob([c],{type:a.mimeType});c=URL.createObjectURL(b);a=new Image();a.src=c;return a};return a}();g["default"]=a}),98);
__d("GLTFTypesValidator",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){throw c("unrecoverableViolation")("unrecoverable incorrectly formatted JSON ".concat(a),"webgl")}function i(a){a===void 0&&h("GLTFAccessor undefined"),s(a.bufferView,!0,"GLTFAccessor.bufferView",0),s(a.byteOffset,!1,"GLTFAccessor.byteOffset",0),s(a.componentType,!0,"GLTFAccessor.componentType",5120,5126),s(a.count,!0,"GLTFAccessor.count",1),a.type!==void 0&&(a.type!=="SCALAR"&&a.type!=="VEC2"&&a.type!=="VEC3"&&a.type!=="VEC4"&&h("GLTFAccessor malformed"))}function j(a){k(a,!0,"GLTFAccessor");if(a!==void 0)for(a of a)i(a)}function k(a,b,c){if(a===void 0)if(b)h("Array<".concat(c).concat("> undefined"));else return;else a.length===0&&h("Array<".concat(c).concat("> length=0"))}function a(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="boolean"&&h(c.concat(" not a boolean"))}function l(a){a===void 0&&h("GLTFBuffer undefined"),s(a.byteLength,!0,"GLTFBuffer.byteLength",1)}function m(a){s(a.buffer,!0,"GLTFBufferView.buffer",0),s(a.byteOffset,!0,"GLTFBufferView.byteOffset",0),s(a.byteLength,!0,"GLTFBufferView.byteLength",0)}function n(a){k(a,!1,"GLTFBufferView");if(a!==void 0)for(a of a)m(a)}function o(a){k(a,!1,"GLTFBuffer");if(a!==void 0)for(a of a)l(a)}function p(a){a!==void 0&&(a.FB_PHOTO_3D_DATA!==void 0?(a.FB_PHOTO_3D_DATA.hFov!==void 0&&s(a.FB_PHOTO_3D_DATA.hFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.hFov"),a.FB_PHOTO_3D_DATA.vFov!==void 0&&s(a.FB_PHOTO_3D_DATA.vFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.vFov")):h("GLTFExtras undefined"))}function b(a){a!==void 0?(j(a.accessors),o(a.buffers),n(a.bufferViews),p(a.extras),r(a.images),u(a.materials),w(a.meshes),B(a.textures)):h("GLTFBody undefined")}function q(a){a===void 0&&h("GLTFImage undefined"),z(a.mimeType,!0,"GLTFImage.mimeType"),s(a.bufferView,!0,"GLTFImage.bufferView",0)}function r(a){k(a,!1,"GLTFImage");if(a!==void 0)for(a of a)q(a)}function s(a,b,c,d,e){d===void 0&&(d=Number.MIN_SAFE_INTEGER);e===void 0&&(e=Number.MAX_SAFE_INTEGER);if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a==="number"?(a<d||a>e)&&h(c.concat(" out of range")):h(c.concat(" not an integer"))}function t(a){a===void 0&&h("GLTFMaterial undefined"),a.pbrMetallicRoughness!==void 0&&(a.pbrMetallicRoughness.baseColorTexture!==void 0&&s(a.pbrMetallicRoughness.baseColorTexture.index,!1,"GLTFMaterial.pbrMetallicRoughness.baseColorTexture.index",0))}function u(a){k(a,!1,"GLTFMaterial");if(a!==void 0)for(a of a)t(a)}function v(a){a===void 0&&h("GLTFMesh undefined"),y(a.primitives)}function w(a){k(a,!0,"GLTFMesh");if(a!==void 0)for(a of a)v(a)}function x(a){a===void 0&&h("GLTFPrimitive undefined");for(var b in a.attributes)Object.prototype.hasOwnProperty.call(a.attributes,b)&&(b==="POSITION"||b==="TEXCOORD_0"||b==="TEXCOORD_1"?s(a.attributes[b],!0,"GLTFPrimitives.attributes[".concat(b).concat("]"),0):h("GLTFPrimitive malformed"));s(a.indices,!1,"GLTFPrimitives.indicies",0);s(a.material,!1,"GLTFPrimitives.material",0)}function y(a){a===void 0&&h("GLTFPrimatives undefined");k(a,!0,"GLTFPrimitive");for(a of a)x(a)}function z(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="string"&&h(c.concat(" not a string"))}function A(a){a===void 0&&h("GLTFTexture undefined"),s(a.sampler,!0,"GLTFTexture.sampler",0),s(a.source,!0,"GLTFTexture.source",0)}function B(a){k(a,!0,"GLTFTexture");if(a!==void 0)for(a of a)A(a)}g.throwBadFormat=h;g.validateAccessor=i;g.validateAccessors=j;g.validateArray=k;g.validateBoolean=a;g.validateBuffer=l;g.validateBufferView=m;g.validateBufferViews=n;g.validateBuffers=o;g.validateExtras=p;g.validateGLTFBodyJSON=b;g.validateImage=q;g.validateImages=r;g.validateInteger=s;g.validateMaterial=t;g.validateMaterials=u;g.validateMesh=v;g.validateMeshes=w;g.validatePrimitive=x;g.validatePrimitives=y;g.validateString=z;g.validateTexture=A;g.validateTextures=B}),98);
__d("extractUTF8StringFromBuffer",["EndianAwareDataReader","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a>127}function i(a){return a>=192&&a<=223}function j(a){return a>=224&&a<=239}function k(a){return a>=240&&a<=247}function a(a,b,d){if(b+d>a.byteLength)throw c("unrecoverableViolation")("offset and length exceed ArrayBuffer bounds","webgl");if("TextDecoder"in window){var e=new TextDecoder("utf-8"),f=new Uint8Array(a,b,d);return e.decode(f)}e=new(c("EndianAwareDataReader"))(a.slice(b,b+d),!1);f=[];while(e.canReadU8()){a=e.readU8();if(h(a))if(i(a)){if(!e.canReadU8())throw c("unrecoverableViolation")("incomplete two-byte utf8 sequence","webgl");b=e.readU8();a=(a&31)<<6|b&63}else if(j(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;if(d==null||b==null)throw c("unrecoverableViolation")("incomplete three-byte utf8 sequence","webgl");a=(a&15)<<12|(d&63)<<6|b&63}else if(k(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;var g=e.canReadU8()?e.readU8():null;if(d==null||b==null||g==null)throw c("unrecoverableViolation")("incomplete four-byte utf8 sequence","webgl");a=(a&7)<<18|(d&63)<<12|(b&63)<<6|g&63}else throw c("unrecoverableViolation")("unknown utf8 start sequence","webgl");if(a<=65535)f.push(String.fromCharCode(a));else if(a<=1114111)a-=65536,f.push(String.fromCharCode(a>>10|55296)),f.push(String.fromCharCode(a&1023|56320));else throw c("unrecoverableViolation")("codepoint is beyond ","webgl")}return f.join("")}g["default"]=a}),98);
__d("parseGLBResource",["GLTFResource","GLTFTypesValidator","extractUTF8StringFromBuffer","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=1179937895;function a(a){var b=new DataView(a);if(b.getUint32(0,!0)!==h)throw c("unrecoverableViolation")("invalid GLB magic number","webgl");if(b.getUint32(4,!0)!==2)throw c("unrecoverableViolation")("unsupported GLB version number","webgl");var e=b.getUint32(8,!0);if(e>a.byteLength)throw c("unrecoverableViolation")("glb buffer is shorter than declared byte length","webgl");var f=new(c("GLTFResource"))(),g=12;while(g<e){var i=b.getUint32(g,!0),j=b.getUint32(g+4,!0);switch(j){case 1313821514:j=c("extractUTF8StringFromBuffer")(a,g+8,i);var k="";try{k=JSON.parse(j)}catch(a){throw c("unrecoverableViolation")("failed to parse glTF JSON","webgl",a)}d("GLTFTypesValidator").validateGLTFBodyJSON(k);f.useJSON(k);break;case 5130562:f.addBinarySource(a,g+8,i);break;default:throw c("unrecoverableViolation")("unexpected GLB section label","webgl")}g+=i+8}return f}g["default"]=a}),98);
__d("useGLBLoadAndParse",["parseGLBResource","promiseDone","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useState;function a(a){var b=d("react-compiler-runtime").c(3),e=j(null),f=e[0],g=e[1],h;b[0]!==a?(e=function(){var b;b=!1;c("promiseDone")(window.fetch(a).then(k).then(function(a){if(b)return;a=c("parseGLBResource")(a);g(a)})["catch"](function(){g(null)}));return function(){b=!0}},h=[a],b[0]=a,b[1]=e,b[2]=h):(e=b[1],h=b[2]);i(e,h);return f}function k(a){return a.arrayBuffer()}g["default"]=a}),98);
__d("useGLTFDerivedFOV",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;var i=1,j=.508015513,k=.666488587,l=.925,m=Object.freeze({landscape:-.14,portrait:-.124}),n=Object.freeze({landscape:-.124,portrait:-.112}),o=Object.freeze({landscape:.96,portrait:.8}),p=Object.freeze({landscape:.6,portrait:.7});function a(a){var b,c=d("react-compiler-runtime").c(16);b=(b=a==null?void 0:(b=a.getExtras())==null?void 0:(b=b.FB_PHOTO_3D_DATA)==null?void 0:b.vFov)!=null?b:k;b=b*l;b=b;a=(a=a==null?void 0:(a=a.getExtras())==null?void 0:(a=a.FB_PHOTO_3D_DATA)==null?void 0:a.hFov)!=null?a:j;a=a*l;a=a;var e=1/Math.tan(b/2),f=a/b;f=e/f;var g;c[0]!==e||c[1]!==f?(g=[f,0,0,0,0,e,0,0,0,0,-1.0002000200020003,-1,0,0,-.20002000200020004,0],c[0]=e,c[1]=f,c[2]=g):g=c[2];e=g;f=e;g=a>b?"landscape":"portrait";e=m[g];var h=n[g];e=Math.tan(a/2)*i*e;h=Math.tan(b/2)*i*h;var q=1-o[g];g=p[g];var r;c[3]!==e||c[4]!==h||c[5]!==q||c[6]!==g?(r=[e,h,q,g],c[3]=e,c[4]=h,c[5]=q,c[6]=g,c[7]=r):r=c[7];e=r;h=e;q=h[0];g=h[1];r=h[2];e=h[3];c[8]!==a||c[9]!==q||c[10]!==g||c[11]!==f||c[12]!==r||c[13]!==e||c[14]!==b?(h={hFov:a,maxHorizontalAngle:q,maxVerticalAngle:g,projectionMatrix:f,targetInteractionWeightHorizontal:r,targetScrollWeightVertical:e,vFov:b},c[8]=a,c[9]=q,c[10]=g,c[11]=f,c[12]=r,c[13]=e,c[14]=b,c[15]=h):h=c[15];return h}g["default"]=a}),98);
__d("Comet3DPhotoViewer.react",["fbt","CometFeedStoryImmersiveMediaMouseOverlay.react","ConstUriUtils","FDSLazyPopoverTrigger.react","JSResourceForInteraction","Matrices","UserAgent","XR3DPhotoViewerEntry.react","clearTimeout","createMeshesFromGLTF","getCometPrefersReducedMotion","gkx","glMatrixLookingAtTarget","mergeRefs","promiseDone","react","setTimeout","useFrameTiming","useGLBLoadAndParse","useGLContext","useGLTFDerivedFOV","useResizeObserver","useThrottled","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useEffect,aa=b.useMemo,m=b.useRef,n=b.useState,ba=c("JSResourceForInteraction")("CometFeedStory3DPhotoContextMenu.react").__setRef("Comet3DPhotoViewer.react"),o=1,p=.01,ca=.005,da=.1,q=.06,ea=.12,r=c("gkx")("1872")?1:c("getCometPrefersReducedMotion")()?.25:1;function a(a){var b=a.aspectRatio,e=a.fallbackURI,f=a.fileURI,g=a.onLoad,i=a.photoID;a=a.storyContext;var s=c("gkx")("20861"),t=n(!1),u=t[0],v=t[1],w=m(null),x=j.createRef();t=n(1024);var y=t[0],z=t[1];t=c("useGLContext")(y,Math.ceil(y/b),{expand:!0,stencil:!0});var A=t[0],B=t[1];y=c("useFrameTiming")();var C=y[0],D=c("useGLBLoadAndParse")(f);b=n([]);var E=b[0],fa=b[1];l(function(){if(A==null||D==null)return;var a=!1;c("promiseDone")(c("createMeshesFromGLTF")(A,D).then(function(b){if(a)return;fa(b);g&&g();C(V)}));return function(){a=!0}},[A,D,g]);t=c("useGLTFDerivedFOV")(D);var F=t.hFov,G=t.maxHorizontalAngle,H=t.maxVerticalAngle,I=t.projectionMatrix,J=t.targetInteractionWeightHorizontal,K=t.targetScrollWeightVertical,L=t.vFov,M=k(function(){if(A==null||E.length===0)return;A.enable(A.DEPTH_TEST);A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT);A.enable(A.BLEND);A.blendFunc(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA);for(var a of E)a.program.use(),a.draw()},[E,A]),ga=function(){c("clearTimeout")(w.current),w.current=c("setTimeout")(function(){v(!0)},3e3)};y=function(){u&&v(!1),ga()};var N=c("useThrottled")(y,100),O=c("useVisibilityObserver")({onVisible:function(){c("clearTimeout")(w.current),w.current=c("setTimeout")(function(){v(!0)},3e3)}});l(function(){return function(){c("clearTimeout")(w.current)}},[]);var P=m([0,0]),Q=m(1),R=m(1),S=m([0,0]),T=m([0,0]),U=m(0),V=k(function(a){if(A==null)return;if(a!=null){if(U.current!==0){var b=Math.min(a-U.current,50);b=Math.max(Math.min(ca*b,1),0);var d=S.current,e=d[0];d=d[1];var f=T.current,g=f[0];f=f[1];T.current=[g+b*(e-g),f+b*(d-f)];g=Q.current;f=R.current;R.current=f+b*(g-f);(Math.abs(T.current[0]-e)>p||Math.abs(T.current[1]-d)>p||Math.abs(R.current-g)>p)&&C(V)}U.current=a}b=R.current;f=L*ea*(2*b-1)*r;e=(1-2*b)*H;d=T.current;g=d[0];a=d[1];d=Math.sin(g*Math.PI*.5*r);g=Math.sin(a*Math.PI*.5*r);a=L*q*g;var h=F*q*d;d=-d*G;g=-g*H;b=Math.pow(b+.16,3)/(Math.pow(b+.16,3)+Math.pow(1-(b+.16),3))-.9;a=-(a+f);f=-h;h=o-b*da*r;b=[0+h*Math.cos(a)*Math.sin(f),0+h*Math.sin(a),-o+h*Math.cos(a)*Math.cos(f)];h=[-(J*d),-(e*K+g*(1-K)),-o];a=c("glMatrixLookingAtTarget")(b,h);f=c("Matrices").invertMat4(a);for(d of E)d.setUniform("viewMatrix",f),d.setUniform("projectionMatrix",I);M()},[M,A,F,G,H,E,I,C,J,K,L]);l(function(){var a=x==null?void 0:x.current;if(a==null)return;a=a.clientWidth;a!=null&&z(a)},[x]);var W=c("useResizeObserver")(function(a){z(Math.floor(a.width))}),X=k(function(){if(A==null)return;var a=A.canvas,b=0,c=0;while(a!=null)b+=a instanceof HTMLElement?a.offsetLeft:0,c+=a instanceof HTMLElement?a.offsetTop:0,a=a instanceof HTMLElement?a.offsetParent:null;P.current=[b,c]},[P,A]),Y=k(function(){var a;if(A==null)return;X();var b=window.innerHeight,c=A.canvas.clientHeight;b=b+c;a=P.current[1]-((a=(a=document.scrollingElement)==null?void 0:a.scrollTop)!=null?a:0)+c;c=a/b;Q.current=c;if(c<0||c>1)return;C(V)},[P,A,C,V,X]);b=k(function(a){if(A==null)return;X();var b=a.pageX;a=a.pageY;b=b-P.current[0];a=a-P.current[1];b=2*b/A.canvas.clientWidth-1;a=1-2*a/A.canvas.clientHeight;S.current=[b,a];N();if(b<-1||a<-1||b>1||a>1)return;C(V)},[A,S,C,N,V,X]);l(function(){document.addEventListener("scroll",Y);V();return function(){document.removeEventListener("scroll",Y)}},[V,Y]);var Z,$;if(i!=null){Z=(t=d("ConstUriUtils").getUri("/intern/compphoto/x3d/3dphoto_console"))==null?void 0:(y=t.setDomain("our.intern.facebook.com"))==null?void 0:(t=y.setProtocol("https"))==null?void 0:(y=t.addQueryParam("ent_id",i))==null?void 0:y.toString();$=(t=d("ConstUriUtils").getUri("/intern/compphoto/x3d/"+i+"/depth"))==null?void 0:(y=t.setDomain("our.intern.facebook.com"))==null?void 0:(i=y.setProtocol("https"))==null?void 0:i.toString()}t=n(0);y=t[0];var ha=t[1];i=n(0);t=i[0];var ia=i[1],ja=function(a,b){var d=/^a$/i.test(a.target.nodeName||""),e=c("UserAgent").isPlatform("Mac OS X")?a.metaKey:a.ctrlKey;d=!d&&s&&e;d&&(ha(a.nativeEvent.offsetX),ia(a.nativeEvent.offsetY),a.preventDefault(),b())};i=aa(function(){return c("mergeRefs")(B,O,x,W)},[B,O,x,W]);a=c("XR3DPhotoViewerEntry.react")!=null?j.jsx(c("XR3DPhotoViewerEntry.react"),{fov:[F,L],gl:A,meshes:E,storyContext:a}):null;var ka=j.jsxs("div",{onMouseMove:b,ref:i,children:[j.jsx(c("CometFeedStoryImmersiveMediaMouseOverlay.react"),{descriptionFbt:h._(/*BTDS*/"3D\ub85c \uc0ac\uc9c4\uc744 \ubcf4\ub824\uba74 \ub9c8\uc6b0\uc2a4\ub97c \uc6c0\uc9c1\uc5ec\ubcf4\uc138\uc694"),isActive:u,showClick:!1}),a]});b=j.jsx(c("FDSLazyPopoverTrigger.react"),{popoverProps:{consoleURL:Z,depthURL:$,fallbackImgURL:e,fileURL:f,mouseClickX:y,mouseClickY:t},popoverResource:ba,children:function(a,b){return j.jsx("div",babelHelpers["extends"]({className:"x1ey2m1c xds687c x17qophe x10l6tqk x13vifvy"},{onContextMenu:function(a){ja(a,b)},ref:a,children:ka}))}});return s?b:ka}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);